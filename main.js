const dictionary = {
    '홍': [
        { word: '홍수', rest: '처럼 밀려오는 주의 은혜가 당신의 삶에 넘쳐나길 기도합니다' },
        { word: '홍해', rest: '를 가르신 기적의 하나님이 당신의 앞길을 예비하고 계십니다' }
    ],
    '길': [
        { word: '길', rest: '되신 예수님을 따라 걷는 당신의 발걸음마다 평강이 있기를' },
        { word: '길가', rest: '에 핀 꽃 한 송이에서도 주님의 세밀한 사랑을 발견하길 소망합니다' }
    ],
    '동': [
        { word: '동행', rest: '하시는 성령님의 따뜻한 손길이 날마다 당신을 붙들어 주실 것입니다' },
        { word: '동녘', rest: '의 새벽빛처럼 당신의 믿음이 세상을 밝게 비추길 축복합니다' }
    ],
    '이': [
        { word: '이제', rest: '는 내가 사는 것이 아니요 오직 내 안의 주를 위해 사는 기쁨을 누리길' },
        { word: '이슬', rest: '처럼 맑고 순수한 영혼으로 주님의 향기를 전하는 자 되길 바랍니다' }
    ],
    '김': [
        { word: '김', rest: '이 모락모락 나는 생명의 양식처럼 주님의 말씀이 늘 풍성하길' },
        { word: '기도', rest: '의 향연이 하늘 보좌에 상달되어 응답의 기쁨을 누리는 삶 되길' }
    ],
    '박': [
        { word: '박수', rest: '치며 기쁨으로 주님의 이름을 높여 드리는 예배의 삶 되길' },
        { word: '박동', rest: '하는 심장마다 주를 향한 뜨거운 열정과 사랑이 식지 않길 축복합니다' }
    ],
    '최': [
        { word: '최고', rest: '의 예배자로 주님 앞에 서는 당신의 모습이 참으로 아름답습니다' },
        { word: '최선', rest: '을 다해 믿음의 경주를 완주하는 당신에게 생명의 면류관이 예비되어 있습니다' }
    ],
    '정': [
        { word: '정결', rest: '한 마음으로 주님의 얼굴을 구할 때 하늘의 평강이 임할 것입니다' },
        { word: '정의', rest: '가 강물처럼 흐르는 세상을 만드는 복된 통로로 쓰임 받길 원합니다' }
    ],
    '나': [
        { word: '나', rest: '의 힘이 되신 여호와를 날마다 의지하며 넉넉히 승리하는 삶 되길' },
        { word: '나그네', rest: ' 길 인생 속에서도 천국 소망 품고 주와 함께 걷는 당신 되길' }
    ],
    '미': [
        { word: '미소', rest: ' 속에 피어나는 주님의 평강이 만나는 모든 이들에게 전해지길' },
        { word: '미래', rest: '와 희망을 약속하신 신실하신 하나님을 끝까지 신뢰하며 나아가길' }
    ],
    '성': [
        { word: '성령', rest: '의 충만한 기름 부으심이 당신의 모든 사역과 삶 위에 가득하길' },
        { word: '성결', rest: '한 삶을 향한 당신의 거룩한 몸부림을 주께서 귀히 보실 것입니다' }
    ],
    '민': [
        { word: '민족', rest: '과 열방을 가슴에 품고 기도하는 주님의 신실한 일꾼 되길 축복합니다' },
        { word: '민들레', rest: ' 홀씨처럼 복음의 기쁜 소식을 널리 퍼뜨리는 발걸음 되길' }
    ],
    '지': [
        { word: '지혜', rest: '와 계시의 영을 부어주셔서 주님의 뜻을 온전히 분별하길 기도합니다' },
        { word: '지금', rest: '도 당신을 위해 친히 간구하시는 주님의 사랑을 잊지 마세요' }
    ],
    '수': [
        { word: '수고', rest: '하고 무거운 짐을 주님 발 앞에 내려놓고 참된 안식을 누리길' },
        { word: '수정', rest: '처럼 맑은 생명수 강가로 인도하시는 주님의 평안을 누리세요' }
    ],
    '하': [
        { word: '하늘', rest: ' 문을 여시고 감당할 수 없는 복을 당신의 가정 위에 부어주시길' },
        { word: '하나님', rest: '의 형상을 닮은 당신은 이 세상 그 무엇보다 귀하고 소중합니다' }
    ],
    '윤': [
        { word: '윤슬', rest: '처럼 반짝이는 주님의 은혜가 당신의 모든 날을 덮어주시길' },
        { word: '윤택', rest: '한 영혼의 샘물이 마르지 않고 날마다 흘러넘치기를 소망합니다' }
    ],
    '선': [
        { word: '선한', rest: ' 목자 되신 주님이 당신의 일생을 푸른 초장으로 인도하실 것입니다' },
        { word: '선물', rest: '로 주신 귀한 오늘을 주님과 기쁨으로 동행하며 채워가길' }
    ],
    '영': [
        { word: '영원', rest: '하신 주님의 사랑이 당신을 영원토록 지키시고 보호하실 것입니다' },
        { word: '영광', rest: '의 광채가 당신의 얼굴 위에 가득하여 주를 나타내는 삶 되길' }
    ],
    '전': [
        { word: '전능', rest: '하신 하나님의 손길이 당신의 모든 연약함을 강건케 하실 줄 믿습니다' },
        { word: '전심', rest: '으로 주를 찾는 자에게 만나주시는 은혜가 오늘 당신께 있기를' }
    ],
    '진': [
        { word: '진리', rest: '의 말씀이 당신의 앞길을 비추는 영롱한 빛이 되어줄 것입니다' },
        { word: '진실', rest: '한 마음으로 드리는 당신의 예배를 주께서 기쁘게 받으십니다' }
    ],
    '희': [
        { word: '희망', rest: '의 소망을 주시는 주님 안에서 날마다 새 힘을 얻으시길 축복합니다' },
        { word: '희생', rest: '과 사랑으로 헌신하는 당신의 손길을 통해 주의 나라가 확장될 것입니다' }
    ],
    '은': [
        { word: '은혜', rest: '의 보좌 앞으로 담대히 나아가 때를 따라 돕는 복을 누리길' },
        { word: '은총', rest: '의 구름 기둥이 당신이 걷는 모든 길을 시원하게 덮어줄 것입니다' }
    ],
    '혜': [
        { word: '혜안', rest: '을 주셔서 하나님의 선하신 뜻을 온전히 분별하는 지혜자가 되길' },
        { word: '혜택', rest: '받은 자의 사명으로 주신 복을 이웃에게 나누는 아름다운 삶 되길' }
    ]
};

const fallbacks = [
    { word: '{char}심', rest: '으로 주를 경외하는 당신의 삶에 하늘의 복이 가득하길 원합니다' },
    { word: '{char}랑', rest: '스러운 주님의 자녀로서 세상의 빛과 소금이 되는 삶 되길 축복합니다' },
    { word: '{char}성', rest: '스러운 마음으로 주님을 섬기는 당신의 수고를 주께서 기억하십니다' },
    { word: '{char}망', rest: '의 끈을 놓지 않고 기도로 승리하는 당신의 내일을 응원합니다' }
];

const generateBtn = document.getElementById('generateBtn');
const nameInput = document.getElementById('nameInput');
const resultArea = document.getElementById('resultArea');
const poemContent = document.getElementById('poemContent');
const copyBtn = document.getElementById('copyBtn');

generateBtn.addEventListener('click', () => {
    const name = nameInput.value.trim();
    if (!name) {
        alert('성함을 입력해주세요!');
        return;
    }
    generatePoem(name);
});

function generatePoem(name) {
    poemContent.innerHTML = '';
    const characters = name.split('');
    const usedPhrases = new Set();
    
    characters.forEach((char, index) => {
        const line = document.createElement('div');
        line.className = 'poem-line';
        line.style.animationDelay = `${index * 0.4}s`;
        
        let selected;
        if (dictionary[char]) {
            const options = dictionary[char].filter(o => !usedPhrases.has(o.word));
            selected = options.length > 0 ? options[Math.floor(Math.random() * options.length)] : dictionary[char][0];
        } else {
            const raw = fallbacks[Math.floor(Math.random() * fallbacks.length)];
            selected = {
                word: raw.word.replace('{char}', char),
                rest: raw.rest
            };
        }
        usedPhrases.add(selected.word);

        // 첫 글자 강조 스타일 유지하면서 단어 전체 출력
        const firstChar = selected.word.charAt(0);
        const remainingWord = selected.word.substring(1);
        
        line.innerHTML = `<span class="first-char">${firstChar}</span><span class="word-rest">${remainingWord}</span> ${selected.rest}`;
        poemContent.appendChild(line);
    });

    resultArea.classList.remove('hidden');
    if (window.navigator.vibrate) window.navigator.vibrate(10);

    setTimeout(() => {
        const yOffset = -20; 
        const element = resultArea;
        const y = element.getBoundingClientRect().top + window.pageYOffset + yOffset;
        window.scrollTo({top: y, behavior: 'smooth'});
    }, 100);
}

copyBtn.addEventListener('click', () => {
    const text = Array.from(document.querySelectorAll('.poem-line'))
        .map(el => el.innerText)
        .join('\n');
    
    navigator.clipboard.writeText(text).then(() => {
        const originalText = copyBtn.innerText;
        copyBtn.innerText = '✅ 축복 메시지 복사 완료!';
        copyBtn.classList.add('success');
        setTimeout(() => {
            copyBtn.innerText = originalText;
            copyBtn.classList.remove('success');
        }, 2000);
    });
});

nameInput.addEventListener('keypress', (e) => {
    if (e.key === 'Enter') {
        generateBtn.click();
        nameInput.blur();
    }
});
