const dictionary = {
    '홍': [
        { word: '홍수', rest: '같이 넘쳐나는 주의 은혜가 당신의 평생에 마르지 않기를 축복합니다' },
        { word: '홍해', rest: '를 가르신 기적이 당신의 삶에 가로막힌 모든 문을 여는 열쇠가 되길' }
    ],
    '김': [
        { word: '기도', rest: '의 향연이 하늘 보좌에 닿아 당신의 모든 간구가 응답되는 기쁨을 누리소서' },
        { word: '기쁨', rest: '이 샘물처럼 솟아올라 당신을 만나는 모든 이들에게 주님의 사랑이 전해지길' }
    ],
    '이': [
        { word: '이제', rest: '는 주님 안에서 참된 안식을 누리며 날마다 새 소망으로 일어나는 복된 날 되소서' },
        { word: '이슬', rest: '같이 맑고 순수한 영혼으로 세상을 적시며 주의 향기를 전하는 자 되길 바랍니다' }
    ],
    '박': [
        { word: '박수', rest: ' 소리와 찬양이 끊이지 않는 당신의 삶이 하늘의 기쁨이 될 것을 믿습니다' },
        { word: '박동', rest: '하는 심장마다 주를 향한 뜨거운 사랑과 감격이 날마다 새로워지길 소망합니다' }
    ],
    '최': [
        { word: '최고', rest: '의 선물인 예수 그리스도와 동행하며 매 순간이 기적 같은 은혜를 누리길 축복합니다' },
        { word: '최선', rest: '을 다해 믿음의 선한 싸움을 싸우는 당신의 등 뒤에서 주님이 늘 응원하고 계십니다' }
    ],
    '정': [
        { word: '정결', rest: '한 마음으로 주님 앞에 설 때 하늘의 신령한 지혜와 평강이 당신을 덮을 것입니다' },
        { word: '정의', rest: '가 강물처럼 흐르는 세상을 만드는 데 주님의 귀한 통로로 쓰임 받는 인생 되소서' }
    ],
    '강': [
        { word: '강건', rest: '함과 평안이 당신의 가정과 일터 위에 영원히 함께하시기를 간절히 기도합니다' },
        { word: '강가', rest: '에 심은 나무가 시절을 좇아 과실을 맺듯 당신의 삶에 풍성한 성령의 열매가 맺히길' }
    ],
    '조': [
        { word: '조용', rest: '히 주의 음성에 귀 기울일 때 세상이 줄 수 없는 하늘의 위로가 임하길 소망합니다' },
        { word: '조화', rest: '로운 삶의 고백을 통해 주님의 아름다우심이 당신의 인격에서 빛나기를 원합니다' }
    ],
    '윤': [
        { word: '윤슬', rest: '처럼 반짝이는 주님의 은혜가 당신의 모든 날들을 찬란하게 비추어 주시길 축복합니다' },
        { word: '윤택', rest: '한 영혼의 복이 당신의 자손 대대로 이어져 축복의 명문을 이루는 역사가 있길' }
    ],
    '성': [
        { word: '성령', rest: '의 충만한 기름 부으심이 당신의 사역과 삶의 모든 영역에 넘쳐나기를 기도합니다' },
        { word: '성실', rest: '한 삶의 향기로 하나님의 살아계심을 온 세상에 증거하는 복된 증인 되소서' }
    ],
    '은': [
        { word: '은혜', rest: ' 아래 거하는 삶이 얼마나 행복한지 당신의 얼굴을 통해 많은 이들이 보게 되길' },
        { word: '은총', rest: '의 구름 기둥이 당신이 걷는 모든 길을 시원하게 덮으시고 인도하여 주실 것입니다' }
    ],
    '현': [
        { word: '현명', rest: '한 지혜로 선한 길을 선택하며 하나님을 날마다 기쁘시게 하는 삶 살아가길 원합니다' },
        { word: '현존', rest: '하시는 하나님의 영광을 대면하며 그리스도의 장성한 분량까지 자라나는 당신 되길' }
    ],
    '재': [
        { word: '재능', rest: '을 통해 주님의 나라를 확장하며 많은 영혼을 주께로 인도하는 별과 같이 빛나소서' },
        { word: '재창조', rest: '하시는 주님의 손길로 날마다 당신의 영혼이 새로워지는 은혜를 만끽하길' }
    ],
    '서': [
        { word: '서광', rest: '이 비치는 아침처럼 당신의 삶에 새로운 소망과 축복의 문이 활짝 열리길 기도합니다' },
        { word: '서로', rest: ' 사랑하라는 주의 말씀을 온전히 이루어 드리는 사랑의 통로로 쓰임 받기를' }
    ],
    '민': [
        { word: '민족', rest: '과 열방을 품고 기도하는 당신의 눈물을 주께서 보석처럼 귀히 여기시고 기억하십니다' },
        { word: '민들레', rest: ' 홀씨처럼 주의 복음이 당신의 발걸음을 통해 세상 끝까지 전파되길 축복합니다' }
    ],
    '유': [
        { word: '유일', rest: '하신 하나님만을 온전히 경외하며 흔들리지 않는 믿음의 반석 위에 굳게 서시길' },
        { word: '유업', rest: '으로 주신 하늘의 신령한 보화가 당신의 삶과 가정에 차고 넘치기를 소망합니다' }
    ],
    '한': [
        { word: '하늘', rest: ' 문을 여시고 쌓을 곳이 없도록 부으시는 풍성한 하늘 복을 매일 경험하는 삶 되길' },
        { word: '한결', rest: '같은 주님의 인자하심이 당신의 고단한 마음을 따뜻하게 안아 주실 줄 믿습니다' }
    ],
    '진': [
        { word: '진리', rest: '의 말씀이 당신의 앞길을 비추는 영롱한 빛이 되어 당신을 실족치 않게 지켜주길' },
        { word: '진실', rest: '한 마음으로 드리는 당신의 예배를 하나님께서 향기로운 제물로 기쁘게 받으십니다' }
    ],
    '희': [
        { word: '희망', rest: '의 소망을 주시는 주님 안에서 날마다 새 힘을 얻고 독수리같이 날아오르길 축복합니다' },
        { word: '희귀', rest: '하고 존귀한 보석보다 당신의 존재를 더 사랑하시는 하나님의 마음을 깊이 누리소서' }
    ],
    '영': [
        { word: '영원', rest: '하신 주님의 팔이 당신을 붙드시고 모든 환난에서 건져 평안케 하실 것입니다' },
        { word: '영광', rest: '의 빛이 당신의 삶 구석구석을 비추어 어둠을 몰아내고 생명을 노래하게 하시길' }
    ],
    '준': [
        { word: '준비', rest: '하신 여호와 이레의 복이 당신의 삶에 적시적소에 임하는 기적을 날마다 체험하길' },
        { word: '준엄', rest: '한 주의 말씀 앞에 겸손히 순종하며 거룩한 길 걷는 주님의 신실한 자녀 되소서' }
    ],
    '훈': [
        { word: '훈훈', rest: '한 성령의 바람이 당신의 마음에 불어와 아름다운 사랑의 열매가 맺히게 하시길' },
        { word: '훈계', rest: '의 말씀을 금보다 귀히 여겨 명철한 지혜자의 반열에 서는 복된 인생 되길 축복합니다' }
    ],
    '지': [
        { word: '지혜', rest: '와 명철을 하늘로부터 공급받아 하나님의 선하신 뜻을 온전히 이루어 드리는 삶 되길' },
        { word: '지금', rest: ' 이 순간도 주님은 당신을 위해 말할 수 없는 탄식으로 중보하며 응원하고 계십니다' }
    ],
    '하': [
        { word: '하나님', rest: '의 형상을 닮은 당신은 존재 자체로 세상을 향한 주님의 가장 아름다운 편지입니다' },
        { word: '하늘', rest: ' 가득한 주님의 영광이 당신의 평생에 찬란한 소망으로 머물기를 축원합니다' }
    ],
    '나': [
        { word: '나', rest: '의 힘이 되신 여호와여 내가 주를 사랑합니다라는 진실한 고백이 늘 넘쳐나길' },
        { word: '나그네', rest: ' 인생길에서도 천국 시민권을 가진 자의 당당함과 기쁨으로 승리하며 살아가소서' }
    ],
    '수': [
        { word: '수고', rest: '하고 무거운 짐을 모두 주님께 맡기고 주가 주시는 참된 평안과 쉼을 얻기를' },
        { word: '수정', rest: '같이 맑은 생명수 강가로 당신의 영혼을 인도하시는 주님의 평안을 누리소서' }
    ],
    '주': [
        { word: '주님', rest: '만이 내 삶의 유일한 고백이며 소망임을 날마다 체험하는 복된 인생 되길' },
        { word: '주권', rest: '자 되신 하나님께서 당신의 삶을 가장 선한 길로 완벽하게 인도하고 계십니다' }
    ],
    '신': [
        { word: '신실', rest: '하신 하나님이 당신의 약속을 어기지 않으시고 반드시 이루시는 기적을 보게 되길' },
        { word: '신령', rest: '한 복과 땅의 기름진 복이 당신의 삶과 가정 위에 가득히 넘쳐나기를 축복합니다' }
    ],
    '예': [
        { word: '예수', rest: ' 그리스도의 이름 안에 있는 생명의 능력이 당신을 날마다 새롭게 하실 줄 믿습니다' },
        { word: '예비', rest: '하신 예비의 은혜가 당신의 발걸음 닿는 곳마다 미리 기다리고 있을 것입니다' }
    ],
    '찬': [
        { word: '찬양', rest: '의 제사가 당신의 입술에서 떠나지 않아 하늘의 문이 열리는 복을 누리길 원합니다' },
        { word: '찬란', rest: '한 주의 영광이 당신의 삶 위에 머물러 세상을 밝히는 등불의 사명을 다하소서' }
    ]
};

const fallbacks = [
    { word: '{char}심', rest: '으로 주를 경외하는 당신의 삶에 하늘의 평강이 가득하길 소망합니다' },
    { word: '{char}랑', rest: '스러운 주님의 자녀로서 세상에 선한 영향력을 끼치는 복된 통로 되길 축복합니다' },
    { word: '{char}성', rest: '스러운 마음으로 주님을 섬기는 당신의 수고를 주께서 결코 잊지 않으실 것입니다' },
    { word: '{char}망', rest: '의 소망을 품고 끝까지 인내하며 믿음의 열매를 거두는 승리자 되길 원합니다' },
    { word: '{char}평', rest: '안의 매는 줄로 성령의 하나 되게 하신 것을 힘써 지키는 평화의 사절 되소서' },
    { word: '{char}광', rest: '스러운 주님의 일에 기쁨으로 동참하여 하늘의 상급을 예비하는 당신 되길' }
];

const generateBtn = document.getElementById('generateBtn');
const nameInput = document.getElementById('nameInput');
const resultArea = document.getElementById('resultArea');
const poemContent = document.getElementById('poemContent');
const copyBtn = document.getElementById('copyBtn');

generateBtn.addEventListener('click', () => {
    const name = nameInput.value.trim();
    if (!name) {
        alert('성함을 입력해주세요!');
        return;
    }
    generatePoem(name);
});

function generatePoem(name) {
    poemContent.innerHTML = '';
    const characters = name.split('');
    const usedWords = new Set();
    
    characters.forEach((char, index) => {
        const line = document.createElement('div');
        line.className = 'poem-line';
        line.style.animationDelay = `${index * 0.4}s`;
        
        let selected;
        if (dictionary[char]) {
            const options = dictionary[char].filter(o => !usedWords.has(o.word));
            selected = options.length > 0 ? options[Math.floor(Math.random() * options.length)] : dictionary[char][0];
        } else {
            const options = fallbacks.filter(o => !usedWords.has(o.word.replace('{char}', char)));
            const raw = options.length > 0 ? options[Math.floor(Math.random() * options.length)] : fallbacks[0];
            selected = {
                word: raw.word.replace('{char}', char),
                rest: raw.rest
            };
        }
        usedWords.add(selected.word);

        const firstChar = selected.word.charAt(0);
        const remainingWord = selected.word.substring(1);
        
        line.innerHTML = `<span class="first-char">${firstChar}</span><span class="word-rest">${remainingWord}</span>${selected.rest}`;
        poemContent.appendChild(line);
    });

    resultArea.classList.remove('hidden');
    if (window.navigator.vibrate) window.navigator.vibrate(10);

    // 가시성 보장을 위해 약간의 지연 후 스크롤
    setTimeout(() => {
        const yOffset = -50; // 여백 확보
        const y = resultArea.getBoundingClientRect().top + window.pageYOffset + yOffset;
        window.scrollTo({top: y, behavior: 'smooth'});
    }, 150);
}

copyBtn.addEventListener('click', () => {
    const text = Array.from(document.querySelectorAll('.poem-line'))
        .map(el => el.innerText)
        .join('\n');
    
    navigator.clipboard.writeText(text).then(() => {
        const originalText = copyBtn.innerText;
        copyBtn.innerText = '✅ 축복 메시지 복사 완료!';
        copyBtn.classList.add('success');
        setTimeout(() => {
            copyBtn.innerText = originalText;
            copyBtn.classList.remove('success');
        }, 2000);
    });
});

nameInput.addEventListener('keypress', (e) => {
    if (e.key === 'Enter') {
        generateBtn.click();
        nameInput.blur();
    }
});
